<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ESP32 Watch Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin:0;
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(135deg,#050505,#111827,#0b0f31,#050505);
  background-size: 400% 400%;
  animation: gradient 12s ease infinite;
  color:white;
  text-align:center;
  padding:20px;
}
@keyframes gradient {
  0% {background-position:0% 50%;}
  50% {background-position:100% 50%;}
  100% {background-position:0% 50%;}
}

h1 {
  font-size:32px;
  font-weight:600;
  background: linear-gradient(to right,#00ffa6,#33c9ff);
  -webkit-background-clip:text;
  color:transparent;
  margin-bottom:10px;
}

.section {
  backdrop-filter: blur(10px);
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.1);
  margin:15px auto;
  padding:20px;
  border-radius:18px;
  width:90%;
  max-width:520px;
  box-shadow: 0 0 18px rgba(0,255,180,0.25);
}

button {
  padding:12px 25px;
  margin:6px;
  font-size:18px;
  font-weight:600;
  border:none;
  border-radius:12px;
  background:linear-gradient(135deg,#00ffb3,#0098ff);
  cursor:pointer;
  color:black;
  transition:0.2s;
}
button:hover {
  transform:scale(1.06);
  box-shadow:0 0 15px #00ffc3;
}
button:disabled {
  background:#4a4a4a;
}

input {
  width:180px;
  padding:10px;
  border-radius:10px;
  border:none;
  outline:none;
  font-size:18px;
  background:#1d1d1d;
  color:#00ffc8;
  text-align:center;
}
#status {
  font-size:18px;
  margin-top:10px;
  opacity:0.85;
}
</style>
</head>

<body>

<h1>ESP32 WATCH CONTROL</h1>
<button id="connectBtn">CONNECT</button>
<p id="status">Disconnected</p>

<div class="section">
  <h2>Clock Settings</h2>
  <button onclick="sendCmd('FMT 12')">12-Hour</button>
  <button onclick="sendCmd('FMT 24')">24-Hour</button>
  <br>
  <button onclick="sendCmd('SEC ON')">Seconds On</button>
  <button onclick="sendCmd('SEC OFF')">Seconds Off</button>
  <br><br>
  <input id="ts" placeholder="HH:MM:SS">
  <button onclick="sendTime()">Set Time</button>
</div>

<div class="section">
  <h2>Modes</h2>
  <button onclick="sendCmd('MODE CLOCK')">Clock</button>
  <button onclick="sendCmd('MODE TIMER')">Timer</button>
  <button onclick="sendCmd('MODE SW')">Stopwatch</button>
  <button onclick="sendCmd('MODE SLEEP')">Sleep</button>
</div>

<div class="section">
  <h2>Timer</h2>
  <input id="timer" placeholder="MM:SS">
  <button onclick="timerStart()">Start</button>
  <button onclick="sendCmd('TIMER_STOP')">Stop</button>
</div>

<div class="section">
  <h2>Stopwatch</h2>
  <button onclick="sendCmd('SW_START')">Start</button>
  <button onclick="sendCmd('SW_STOP')">Stop</button>
  <button onclick="sendCmd('SW_RESET')">Reset</button>
</div>

<script>
let device, server, service, txChar;

async function connectBLE() {
  try {
    device = await navigator.bluetooth.requestDevice({
      filters:[{name:"ESP32_WATCH"}],
      optionalServices:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]
    });

    server = await device.gatt.connect();
    service = await server.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e");

    txChar = await service.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e");

    document.getElementById("status").innerText = "Connected ✔";
  }
  catch(e){
    document.getElementById("status").innerText = "Failed ❌";
  }
}

function sendCmd(c){
  if(!txChar) return;
  txChar.writeValue(new TextEncoder().encode(c+"\n"));
}

function sendTime(){
  sendCmd("TIME " + document.getElementById("ts").value);
}

function timerStart(){
  const parts=document.getElementById("timer").value.split(":");
  sendCmd(`TIMER_START:${parts[0]}:${parts[1]}`);
}

document.getElementById("connectBtn").onclick = connectBLE;
</script>

</body>
</html>

